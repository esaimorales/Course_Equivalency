<!DOCTYPE html>
<html>
    <head>
        <title>SCU Course Equivalency</title>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    </head>

    <script>
    // $(document).ready(function(){
    //     $('#name-submit').click(function(){
    //         var function_name = 'get_schools';
    //         $.post('ajax.php', {function: function_name}, function(data) {
    //             $('div#schools').append(data);
    //             //console.log(JSON.parse(data).length);
    //         });
    //     });
    // });

    var schoolResults = [{"school":"San Jose State Univeristy"},{"school":"Stanford Univeristy"},{"school":"Univeristy of California, Santa Cruz"}];
    var departmentResults = [{"department":"CSE"}];

    // results of search
    var equivalencies = [{"school_external":"San Jose State Univeristy","department_external":"CSE","number_external":"101","is_equivalent":"0",
                        "school_internal":"Santa Clara University","department_internal":"COEN","number_internal":"204","id_external":"1","id_internal":"16"}];


    function listSchools(){
        var select = document.getElementById('schoolSelect');

        // clear previous options
        // for(var i = 0; i< select.options.length; i++){
        //     select.options[i] = null;
        // }

        for (var i = 0; i<schoolResults.length; i++){
            var obj = schoolResults[i];
            // console.log(obj.school);

            var option = document.createElement("option");
            option.text = obj.school;
            option.value = i;

            select.appendChild(option);
        }
    }

    function listDepartments(){
        var select = document.getElementById('departmentSelect');

        for (var i = 0; i<departmentResults.length; i++){
            var obj = departmentResults[i];
            var option = document.createElement("option");

            option.text = obj.department;
            option.value = i;

            select.appendChild(option);
        }
    }

    function listEquivalencies(){
        var list = document.getElementById('results');

        list.innerHTML = '';
        // for every object in jsonArray, create list element with details
        for (var i = 0; i<equivalencies.length; i++){
            var obj = equivalencies[i];

            // creat list <li> element
            var listItem = document.createElement('LI');

            // set external attributes attributes
            var externalSchool = document.createTextNode(obj.school_external);
            var externalDept = document.createTextNode(obj.department_external);
            var externalCourseNum = document.createTextNode(obj.number_external);

            var internalSchool = document.createTextNode(obj.school_internal);
            var internalDept = document.createTextNode(obj.department_internal);
            var internalCourseNum = document.createTextNode(obj.number_internal);

            var externalId = obj.id_external;
            var internalId = obj.id_internal;

            // list the course equivalencies including:
            // school name, department, and course number
            listItem.appendChild(externalSchool);
            listItem.appendChild(document.createTextNode(' '));
            listItem.appendChild(externalDept);
            listItem.appendChild(document.createTextNode(' - '));
            listItem.appendChild(externalCourseNum);
            listItem.appendChild(document.createTextNode(' | '));

            // if equivalent coourse, print "Equivalent"
            if (obj.is_equivalent == 1){
                console.log('course equivalent');
                listItem.appendChild(document.createTextNode('Equivalent'));
            }
            // else print "Not Equivalent"
            else{
                console.log('course not equivalent');
                listItem.appendChild(document.createTextNode('Not Equivalent'));
            }

            listItem.appendChild(document.createTextNode(' | '));

            listItem.appendChild(internalSchool);
            listItem.appendChild(document.createTextNode(' '));
            listItem.appendChild(internalDept);
            listItem.appendChild(document.createTextNode(' - '));
            listItem.appendChild(internalCourseNum);
            listItem.appendChild(document.createTextNode(' | '));

            // create edit link with proper attributes
            var editLink = document.createElement('a');
            var editLinkText = document.createTextNode('Edit');
            editLink.setAttribute('href', 'edit.html');
            editLink.setAttribute('type', 'submit');
            editLink.setAttribute('id', 'edit_equivalency_btn');
            editLink.setAttribute('onclick', `setCourseIds(${externalId}, ${internalId})`);
            editLink.appendChild(editLinkText);

            // append Edit link to list item
            listItem.appendChild(editLink);
            // separator betweeen edit and remove options
            listItem.appendChild(document.createTextNode(' | '));

            // create remove link with proper attributes
            var removeLink = document.createElement('a');
            var removeLinkText = document.createTextNode('Remove');
            removeLink.setAttribute('href', 'remove.html');
            removeLink.setAttribute('type', 'submit');
            removeLink.setAttribute('id', 'remove_equivalency_btn');
            removeLink.setAttribute('onclick', `setCourseIds(${externalId}, ${internalId})`);
            removeLink.appendChild(removeLinkText);

            // append Remove link to list item
            listItem.appendChild(removeLink);

            // append list item
            list.appendChild(listItem);
        }
    }

    // get ids of list item to be edited or removed
    function setCourseIds(ext_id, int_id){

        console.log(ext_id);
        console.log(int_id);

        // set to session global vars
    }

    </script>

    <!--CHANGE INTO DROPDOWN BOXES LATER ON-->
    <body onload="listSchools(); listDepartments();">

        <div class = "search">
            <h1>Search for a Course:</h1>

            <form>
                <select name="School" id="schoolSelect" value="Get Schools">
                    <option value=""></option>
                </select>

                <select name="Department" id="departmentSelect" value="Get Departments">
                    <option value=""></option>
                    <!-- get values from database -->
                </select>

                <input name="CourseNumber" id="numberSelect" value="Get CourseNumbers" type="number">
                    <!-- get values from database -->
                </input>

                <br></br>
                <input type="button" value="Submit" onclick="listEquivalencies();"></input>
            </form>
            <!-- <label><b>School</b></label>
            <input type = "text" placeholder = "School" name="school" required>

            <label><b>Course</b></label>
            <input type = "text" placeholder = "Course" name="course" required>

            <label><b>Number</b></label>
            <input type = "number" placeholder = "Number" name="number" required> -->

            <!-- <button type="submit" value="search" onclick="search(school,course,number)">Search</button> -->
        </div>

        <div>
            <h3>Equivalent Courses</h3>
            <ul id="results">
            </ul>
        </div>
        <!-- <script language="javascript">
            function search(school,course,number){
                //search through DB for matches
                if(){
                    load(edit.html);
                }
                else{
                    load(login.html);
                }
            }
            function load(url){
                location href=url;
            }
        </script> -->

    </body>
</html>
